import Head from 'next/head'
import Image from 'next/image'
import { Inter } from 'next/font/google'
import Header from '@/copmonent/user/header'
import Sidebar from '@/copmonent/user/sidebar'
import Footer from '@/copmonent/user/footer'
import Rightsidbar from '@/copmonent/user/right-sidebar'
import Skin from '@/copmonent/user/skin'
import { useFormik } from 'formik'

import { useDispatch, useSelector } from 'react-redux'
import { useEffect } from 'react'
import { ToastContainer, toast } from 'react-toastify'
import 'react-toastify/dist/ReactToastify.css';
import { createPayee } from '@/features/payee/payeeSlice'
import { useRouter } from 'next/router'
import { getProfile } from '@/features/profile/profileSlice'
import Link from 'next/link'


// const inter = Inter({ subsets: ['latin'] })

export default function AddDonation() {
    const dispach = useDispatch();
    const route = useRouter();


    // let schema = Yup.object().shape({

    //     email: Yup.string().email("Email should be valid").required("Email is required"),
    //     password: Yup.string().required("Password is required"),

    // });

    const formik = useFormik({
        initialValues: {
            name: '',
            amount: '',
            mobile: '',
            payment_mode: '',
            event_type: '',


        },
        // validationSchema: schema,
        onSubmit: (values) => {

            dispach(createPayee(values));
            console.log(values)
        },

    });
    useEffect(() => {
        dispach(getProfile());
    }, [])


    const { isLoading, isError, isSuccess, message } = useSelector(
        (state) => state.payee
    );
    const userState = useSelector((state) => state.profile.profile);
    const subscribed = userState.isSubscribed

    console.log(subscribed)
    useEffect(() => {
        if (isError === true) {
            toast.error("Not submited")
        } else if (isSuccess === true) {
            toast.success("Donation added Successfully ")
            route.push("/payment-table")

        }
    }, [isError, isSuccess])






    return (
        <>
            <Head>
                <title>Create Next App</title>
                <meta name="description" content="Generated by create next app" />
                <meta name="viewport" content="width=device-width, initial-scale=1" />
                <link rel="icon" href="/favicon.ico" />
            </Head>
            <main>
                <ToastContainer />
                <div className="container-scroller">
                    <Header />
                    <div className="container-fluid page-body-wrapper">
                        {/* <Skin />
                        <Rightsidbar /> */}
                        <Sidebar />
                        <div className="main-panel">
                            <div className="content-wrapper">
                                <div className="row">
                                    <div className="col-md-3"></div>
                                    <div className="col-md-6 grid-margin stretch-card">
                                        <div className="card">
                                            <div className="card-body">

                                                <form onSubmit={formik.handleSubmit} className="forms-sample">
                                                    <div className="form-group">
                                                        <label for="name">Name</label>
                                                        <input type="text"
                                                            className="form-control"
                                                            id="name"
                                                            placeholder="Name"
                                                            onChange={formik.handleChange("name")}
                                                            value={formik.values.name}
                                                            required
                                                        />
                                                    </div>

                                                    <div className="form-group">
                                                        <label for="amount">Amount</label>
                                                        <input type="text"
                                                            className="form-control"
                                                            id="amount"
                                                            placeholder="Amount"
                                                            onChange={formik.handleChange("amount")}
                                                            value={formik.values.amount}
                                                            required
                                                        />
                                                    </div>
                                                    <div className="form-group">
                                                        <label for="mobile-no">Mobile no.</label>
                                                        <input
                                                            type="tel"
                                                            className="form-control"
                                                            id="mobile"
                                                            placeholder="Mobile number"
                                                            onChange={formik.handleChange("mobile")}
                                                            value={formik.values.mobile}
                                                            required
                                                        />
                                                    </div>
                                                    <div className="form-group">
                                                        <label for="mode">Payment mode</label>
                                                        <select
                                                            name="payment_mode"
                                                            id="payment_mode"
                                                            className="form-control"
                                                            onChange={formik.handleChange("payment_mode")}
                                                            value={formik.values.payment_mode}
                                                            required
                                                        >
                                                            <option value="" disabled selected>Select</option>
                                                            <option value="offline"  >Offline</option>
                                                            <option value="Online">Online</option>

                                                        </select>
                                                    </div>
                                                    <div className="form-group">
                                                        <label for="event_type">Event</label>
                                                        <select
                                                            name="event_type"
                                                            id="event_type"
                                                            className="form-control"
                                                            onChange={formik.handleChange("event_type")}
                                                            value={formik.values.event_type}
                                                            required
                                                        >
                                                            <option value="" disabled selected >Select</option>
                                                            <option value="durga puja"  >Dura Puja</option>
                                                            {/* <option value="Online">Diwali</option> */}

                                                        </select>
                                                    </div>
                                                    {/* <input type='date'></input> */}

                                                    {subscribed === true ? <button type="submit" className="btn btn-primary mr-2">Add</button> : <Link href='/subscribe-now'><button type="button" className="btn btn-primary mr-2">Add</button></Link>}
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <Footer />


                        </div >
                    </div >
                </div >

            </main >
        </>
    )
}